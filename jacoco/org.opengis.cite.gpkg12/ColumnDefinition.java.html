<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ColumnDefinition.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">GeoPackage 1.2 Conformance Test Suite</a> &gt; <a href="index.source.html" class="el_package">org.opengis.cite.gpkg12</a> &gt; <span class="el_source">ColumnDefinition.java</span></div><h1>ColumnDefinition.java</h1><pre class="source lang-java linenums">/* The MIT License (MIT)
 *
 * Copyright (c) 2015 Reinventing Geospatial, Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the &quot;Software&quot;), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

package org.opengis.cite.gpkg12;

/**
 * @author Luke Lambert
 *
 */
@SuppressWarnings(&quot;NegativelyNamedBooleanVariable&quot;)
public class ColumnDefinition {

	/**
	 * @param sqlType String representing the SQL type of the column, e.g.: TEXT, INTEGER,
	 * and so on
	 * @param notNull Indicates that this column may not contain null values
	 * @param primaryKey Indicates that this column is the table's primary key (implicitly
	 * unique)
	 * @param unique Indicates that values for this column are unique. If primaryKey is
	 * true, this value is ignored
	 * @param defaultValue String representation for the default value of this column
	 */
	@SuppressWarnings(&quot;BooleanParameter&quot;)
	public ColumnDefinition(final String sqlType, final boolean notNull, final boolean primaryKey, final boolean unique,
<span class="fc" id="L45">			final String defaultValue) {</span>
<span class="pc bpc" id="L46" title="1 of 2 branches missed.">		if (sqlType == null) {</span>
<span class="nc" id="L47">			throw new IllegalArgumentException(&quot;SQL type may not be null&quot;);</span>
		}

<span class="fc" id="L50">		this.sqlType = sqlType;</span>
<span class="fc" id="L51">		this.notNull = notNull;</span>
<span class="fc" id="L52">		this.defaultValue = defaultValue;</span>
<span class="fc" id="L53">		this.primaryKey = primaryKey;</span>
<span class="fc bfc" id="L54" title="All 4 branches covered.">		this.unique = primaryKey || unique;</span>
<span class="fc" id="L55">	}</span>

	@Override
	public boolean equals(final Object object) {
<span class="pc bpc" id="L59" title="1 of 2 branches missed.">		if (!(object instanceof ColumnDefinition)) {</span>
<span class="nc" id="L60">			return false;</span>
		}

<span class="pc bpc" id="L63" title="1 of 2 branches missed.">		if (this == object) {</span>
<span class="nc" id="L64">			return true;</span>
		}

<span class="fc" id="L67">		final ColumnDefinition other = (ColumnDefinition) object;</span>

		// This was added on behalf of Richard Martell, based on the following
		// justification:
		//
		// &quot;According to the SQL standard, PRIMARY KEY should always imply NOT
		// NULL. Unfortunately, due to a bug in some early versions, this is
		// not the case in SQLite. Unless the column is an INTEGER PRIMARY KEY
		// or the table is a WITHOUT ROWID table or the column is declared NOT
		// NULL, SQLite allows NULL values in a PRIMARY KEY column. SQLite
		// could be fixed to conform to the standard, but doing so might break
		// legacy applications. Hence, it has been decided to merely document
		// the fact that SQLite allowing NULLs in most PRIMARY KEY columns.&quot;
		//
		// ref: https://www.sqlite.org/lang_createtable.html#constraints
		//
		// This addition allows the column definition checks to be more
		// permissive (i.e. allow implicit NOT NULL) for PK columns of type
		// INTEGER.
<span class="fc bfc" id="L86" title="All 4 branches covered.">		final boolean implicitNotNull = this.primaryKey &amp;&amp; this.sqlType.toUpperCase().equals(&quot;INTEGER&quot;);</span>

<span class="pc bpc" id="L88" title="4 of 10 branches missed.">		return this.sqlType.equals(other.sqlType) &amp;&amp; ((this.notNull == other.notNull) || implicitNotNull)</span>
				&amp;&amp; this.primaryKey == other.primaryKey
				&amp;&amp; this.unique == other.unique /*
												 * &amp;&amp; (this.defaultValue == null ?
												 * other.defaultValue == null :
												 * this.defaultValue.equals(other.
												 * defaultValue))
												 */; // Skip the test for equality in
														// favor of a functional
														// equivalence test with a query
	}

	@Override
	public int hashCode() {
<span class="nc bnc" id="L102" title="All 6 branches missed.">		return this.sqlType.hashCode() ^ (this.notNull ? 1 : 0) ^ (this.primaryKey ? 1 : 0) ^ (this.unique ? 1 : 0)</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">				^ (this.defaultValue == null ? 0 : this.defaultValue.hashCode());</span>
	}

	@Override
	public String toString() {
<span class="nc" id="L108">		return String.format(&quot;Type: %s, not null: %s, default value: %s, primary key: %s, unique: %s&quot;, this.sqlType,</span>
<span class="nc" id="L109">				this.notNull, this.defaultValue, this.primaryKey, this.unique);</span>
	}

	public String getDefaultValue() {
<span class="fc" id="L113">		return this.defaultValue;</span>
	}

	private final String sqlType;

	private final boolean notNull;

	private final boolean primaryKey;

	private final boolean unique;

	private final String defaultValue;

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>